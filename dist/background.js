(()=>{"use strict";let t,e,a;function o(o){chrome.tabs.get(o,(i=>{if(console.log("Updating tab usage for:",i.url),t&&e&&a){const t=Date.now()-e;console.log("Updating usage data:",a,t),function(t,e){console.log("Updating usage data:",t,e),chrome.storage.local.get(["usageData"],(a=>{const o=a.usageData||{},i=(new Date).toISOString().split("T")[0];o[i]||(o[i]={}),o[i][t]||(o[i][t]=0),o[i][t]+=e,chrome.storage.local.set({usageData:o},(()=>{console.log("Usage data updated:",JSON.stringify(o,null,2))}))}))}(a,t)}var s;i.url&&(s=i.url,["facebook.com","twitter.com","instagram.com"].some((t=>s.includes(t))))?(console.log("Social media site detected:",i.url),t=o,e=Date.now(),a=function(t){const e=t.match(/^https?:\/\/([^/?#]+)(?:[/?#]|$)/i);return e&&e[1]?e[1]:"unknown"}(i.url),function(){const t=(new Date).toISOString().split("T")[0];chrome.storage.local.get(["usageData","settings"],(e=>{var a;const o=(null===(a=e.usageData)||void 0===a?void 0:a[t])||{},i=e.settings||{dailyLimit:120};Object.values(o).reduce(((t,e)=>t+e),0)>6e4*i.dailyLimit&&chrome.notifications.create({type:"basic",iconUrl:"icon128.png",title:"Daily Limit Reached",message:`You've reached your daily social media usage limit of ${i.dailyLimit} minutes.`})}))}()):(console.log("Not a social media site:",i.url),t=void 0,e=void 0,a=void 0)}))}chrome.tabs.onActivated.addListener((t=>{o(t.tabId)})),chrome.tabs.onUpdated.addListener(((t,e,a)=>{"complete"===e.status&&o(t)}))})();